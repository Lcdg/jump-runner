# Story 4.4: Obstacles Sol - Poubelle, Cône, Voiture

## Status

Done

## Story

**As a** player,
**I want** to see recognizable urban obstacles,
**so that** I can quickly identify what to avoid.

## Acceptance Criteria

1. **Poubelle** : Rectangle vert (`#386641`) + couvercle, ~30x50px, petit saut
2. **Cône de chantier** : Triangle orange (`#FF9F1C`) + bandes blanches, ~25x40px, petit saut
3. **Voiture garée** : Corps coloré (`#9B2335` ou `#3D5A80`) + roues noires + phares jaunes, ~100x45px, grand saut
4. Hitbox adaptée à chaque forme d'obstacle
5. Spawn aléatoire parmi les types d'obstacles
6. Tests unitaires pour chaque type d'obstacle
7. Tests E2E : vérifier que les obstacles sont reconnaissables

## Tasks / Subtasks

- [x] **Task 1: Créer enum ObstacleType** (AC: 1, 2, 3)
  - [x] Type 'trashCan', 'cone', 'car' dans types.ts
  - [x] Dimensions par type dans constants.ts (OBSTACLE_TYPES)

- [x] **Task 2: Mettre à jour Obstacle.ts** (AC: 4)
  - [x] Ajouter property type: ObstacleType
  - [x] Dimensions dynamiques selon le type
  - [x] Hitbox adaptée par type

- [x] **Task 3: Implémenter rendu par type** (AC: 1, 2, 3)
  - [x] renderTrashCan() - rectangle vert + couvercle
  - [x] renderCone() - triangle orange + bandes blanches
  - [x] renderCar() - corps + toit + roues + phares

- [x] **Task 4: Spawn aléatoire** (AC: 5)
  - [x] Random type selection avec poids
  - [x] Pondération: 40% trashCan, 40% cone, 20% car

- [x] **Task 5: Tests et Validation** (AC: 6, 7)
  - [x] Tests unitaires Obstacle types (14 tests)
  - [x] `npm run lint` passe
  - [x] `npm run test:run` passe (209 tests)
  - [x] `npm run build` passe

## Dev Notes

### Architecture

```typescript
type ObstacleType = 'trashCan' | 'cone' | 'car';

export const OBSTACLE_TYPES = {
  trashCan: {
    width: 30,
    height: 50,
  },
  cone: {
    width: 25,
    height: 40,
  },
  car: {
    width: 100,
    height: 45,
  },
} as const;
```

### Spawn Weights

Pour équilibrer le gameplay :
- Poubelle: 40%
- Cône: 40%
- Voiture: 20%

## Testing

| Type | Framework | Location |
|------|-----------|----------|
| Unit | Vitest | tests/unit/entities/Obstacle.test.ts |

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-18 | 1.0 | Story créée | Dev Agent (James) |
