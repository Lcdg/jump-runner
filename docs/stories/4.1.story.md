# Story 4.1: Palette Couleurs "Ville de Nuit"

## Status

Done

## Story

**As a** player,
**I want** to see a cohesive night city color palette,
**so that** the game has a distinct visual identity.

## Acceptance Criteria

1. Couleur ciel : `#0D1B2A` (bleu nuit profond)
2. Couleur sol/trottoir : `#415A77` (gris béton)
3. Couleur personnage : `#FF6B35` (corps) et `#FF8C42` (tête)
4. Toutes les couleurs du front-end-spec.md intégrées dans constants.ts
5. Tests visuels : le jeu affiche les nouvelles couleurs
6. Aucune régression de performance (60 FPS maintenu)

## Tasks / Subtasks

- [x] **Task 1: Mettre à jour COLORS dans constants.ts** (AC: 1, 2, 3, 4)
  - [x] Couleurs de fond (SKY, GROUND)
  - [x] Couleurs personnage (PLAYER_BODY, PLAYER_HEAD)
  - [x] Couleurs obstacles
  - [x] Couleurs UI

- [x] **Task 2: Ajouter nouvelles constantes couleurs** (AC: 4)
  - [x] COLORS.GROUND_LINE (passages piétons)
  - [x] COLORS.BUILDING (immeubles arrière-plan)
  - [x] COLORS.WINDOW (fenêtres éclairées)
  - [x] COLORS.STREETLIGHT_HALO (halo lampadaires)

- [x] **Task 3: Mettre à jour OBSTACLE colors** (AC: 4)
  - [x] Créé OBSTACLE_COLORS avec tous les types
  - [x] Couleurs poubelle, cône, voiture, banc, borne

- [x] **Task 4: Mettre à jour UI colors** (AC: 4)
  - [x] COLORS.SCORE
  - [x] COLORS.OVERLAY_BG
  - [x] COLORS.GAME_OVER

- [x] **Task 5: Validation** (AC: 5, 6)
  - [x] `npm run lint` passe
  - [x] `npm run test:run` passe (207 tests)
  - [x] `npm run build` passe
  - [x] Tests mis à jour pour nouvelles constantes CANVAS

## Dev Notes

### Source: front-end-spec.md

**Palette complète à implémenter:**

| Catégorie | Couleur | Hex |
|-----------|---------|-----|
| Background - Ciel | Bleu nuit profond | `#0D1B2A` |
| Background - Immeubles | Gris anthracite | `#1B263B` |
| Fenêtres éclairées | Jaune chaud | `#FFD60A` |
| Sol - Trottoir | Gris béton | `#415A77` |
| Passages piétons | Blanc cassé | `#E0E1DD` |
| Personnage - Corps | Orange vif | `#FF6B35` |
| Personnage - Tête | Orange clair | `#FF8C42` |
| Obstacles - Poubelle | Vert foncé | `#386641` |
| Obstacles - Cône | Orange signalisation | `#FF9F1C` |
| Obstacles - Voiture | Rouge brique | `#9B2335` |
| Obstacles - Voiture alt | Bleu acier | `#3D5A80` |
| Phares voiture | Jaune vif | `#FFEA00` |
| Lampadaires - Halo | Jaune doux | `#FFF3B0` |
| UI - Score | Blanc pur | `#FFFFFF` |
| UI - Overlay | Noir semi-transparent | `#000000CC` |
| UI - Game Over | Rouge erreur | `#E63946` |

## Testing

| Type | Framework | Location |
|------|-----------|----------|
| Unit | Vitest | N/A (changement visuel) |

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-18 | 1.0 | Story créée | Dev Agent (James) |

---

## Dev Agent Record

### Agent Model Used
Claude Opus 4.5 (claude-opus-4-5-20251101)

### Completion Notes List
- Palette complète "Ville de Nuit" intégrée dans constants.ts
- Nouveau bloc OBSTACLE_COLORS pour les différents types d'obstacles
- CANVAS.GROUND_Y_PERCENT changé de 0.8 à 0.85 (per front-end-spec)
- CANVAS.PLAYER_X_PERCENT changé de 0.15 à 0.2 (per front-end-spec)
- Game Over overlay utilise maintenant COLORS.GAME_OVER
- Tests Renderer mis à jour pour les nouvelles constantes

### File List
**Modified:**
- `src/config/constants.ts` - Palette couleurs complète + OBSTACLE_COLORS
- `src/core/Game.ts` - Utilise COLORS.GAME_OVER pour le Game Over
- `tests/unit/rendering/Renderer.test.ts` - Tests mis à jour
